<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>才能8軸診断（ベータ版）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- レーダーチャート用：Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 16px;
      line-height: 1.7;
      background: #f7f7fb;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px 18px;
      margin: 12px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    }
    .question {
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #eee;
    }
    .question:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }
    .question-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 0.9rem;
    }
    label.option {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #ddd;
      cursor: pointer;
      background: #fafafa;
    }
    input[type="radio"] {
      cursor: pointer;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      background: #4b7bec;
      color: white;
      margin-top: 8px;
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
    }
    .small {
      font-size: 0.85rem;
      color: #666;
    }
    .result-title {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .axis-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin: 6px 0;
      font-size: 0.95rem;
    }
    .axis-label {
      min-width: 190px;
    }
    .axis-bar-wrap {
      flex: 1;
      background: #f0f0f5;
      border-radius: 999px;
      overflow: hidden;
      height: 10px;
    }
    .axis-bar {
      height: 100%;
      width: 0%;
      background: #4b7bec;
      transition: width 0.4s;
    }
    .axis-percent {
      min-width: 40px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
    .badge {
      display: inline-block;
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #3730a3;
      margin-left: 4px;
    }
    .type-name {
      font-size: 1.05rem;
      font-weight: 600;
    }
  </style>
</head>
<body>

  <div class="card">
    <h1>才能8軸診断（ベータ版）</h1>
    <p class="small">
      あなたの中にある<strong>実行・影響・思考・人間関係</strong>の4ドメインを、さらに8つの軸に分けて見ていきます。<br>
      48個の質問に、直感で1〜5を選んでください。
    </p>
    <p class="small">
      1：まったく当てはまらない／2：あまり当てはまらない／3：どちらともいえない／4：かなり当てはまる／5：とても当てはまる
    </p>
  </div>

  <form id="quizForm" class="card">
    <div id="questionsContainer"></div>
    <button type="submit">結果を見る</button>
    <p class="small">※すべての質問に回答してからボタンを押してください。</p>
  </form>

  <div id="resultCard" class="card" style="display:none;">
    <div id="resultContent"></div>
        <div id="resultShare" style="display:none; margin-top:12px;">
      <button type="button" id="copyResultBtn">結果テキストをコピー</button>
      <button type="button" id="shareResultBtn">結果をシェア</button>
      <p id="shareMessage" class="small"></p>
    </div>


    <hr style="margin:14px 0;">
    <div class="result-title">4ドメインのレーダーチャート</div>
    <p class="small">全体のバランスを感覚的に眺めてみてください。</p>
    <canvas id="domainRadar" style="max-width: 100%;"></canvas>
  </div>

  <script>
    // ---- 8軸定義 ----
    const axes = {
      X1: { id: "X1", label: "構築・段取り軸", domain: "実行タイプ" },
      X2: { id: "X2", label: "遂行・やり切り軸", domain: "実行タイプ" },
      I1: { id: "I1", label: "発信・存在感軸", domain: "影響タイプ" },
      I2: { id: "I2", label: "説得・推進軸", domain: "影響タイプ" },
      T1: { id: "T1", label: "ロジカル・分析軸", domain: "思考タイプ" },
      T2: { id: "T2", label: "学習・探究軸", domain: "思考タイプ" },
      R1: { id: "R1", label: "共感・ケア軸", domain: "人間関係タイプ" },
      R2: { id: "R2", label: "協働・チーム軸", domain: "人間関係タイプ" }
    };

    const domainDescriptions = {
      "実行タイプ": "やることを整理し、現実を前に進めていくドメイン。計画を立てる／段取りする／やり切る力。",
      "影響タイプ": "人前に立ったり発信したりしながら、人や場を動かしていくドメイン。",
      "思考タイプ": "情報を集めて整理し、本質を理解しようとするドメイン。考える・学ぶことが土台。",
      "人間関係タイプ": "人の気持ちや関係性、チームの空気を大事にするドメイン。安心できる場づくりに向く。"
    };

    const axisDescriptions = {
      X1: "やることを整理し、流れや手順を組み立てる力。段取り・仕組み化・土台づくりが得意な軸です。",
      X2: "決めたことを粘り強くやり切る力。コツコツ続ける・最後まで終わらせるところで力を発揮する軸です。",
      I1: "前に出て話す／発信する／場を明るくする力。存在感や声でエネルギーを動かす軸です。",
      I2: "人を納得させ、合意をつくり、巻き込みながら進める力。プレゼン・営業・リーダーシップに通じる軸です。",
      T1: "情報や出来事を整理し、構造化して考える力。ロジカルに分析して判断する軸です。",
      T2: "深く学び、探究し続ける力。知識や経験を蓄えて、自分なりに理解を深めていく軸です。",
      R1: "人の気持ちに気づき、そっと寄りそう力。1対1の信頼関係やケアで力を発揮する軸です。",
      R2: "人と一緒に進め、チームとしてうまく回す力。調整・サポート・チームビルディングの軸です。"
    };

    // ---- 質問定義（48問） ----
    const questions = [
      // X1 構築・段取り軸
      { id: 1, axis: "X1", text: "やることを紙やアプリにリスト化してから行動することが多い。" },
      { id: 2, axis: "X1", text: "物事を進める前に、手順や流れを整理したくなる。" },
      { id: 3, axis: "X1", text: "「この順番でやると効率がいい」と考えながら動いている。" },
      { id: 4, axis: "X1", text: "仕事や家事のやり方を、もっと楽になるように工夫するのが好きだ。" },
      { id: 5, axis: "X1", text: "みんなが迷わないように、ルールや仕組みを整えたくなる。" },
      { id: 6, axis: "X1", text: "ゴールから逆算してスケジュールを組むのが得意だと感じる。" },

      // X2 遂行・やり切り軸
      { id: 7, axis: "X2", text: "途中で投げ出すのが嫌で、つい最後までやり切ってしまう。" },
      { id: 8, axis: "X2", text: "締め切りが近づくと、むしろ集中力が高まるほうだ。" },
      { id: 9, axis: "X2", text: "「途中までやって放置」が気持ち悪く感じる。" },
      { id: 10, axis: "X2", text: "大変でも、一度引き受けたことはやり遂げたいと思う。" },
      { id: 11, axis: "X2", text: "人から頼まれたことを忘れないよう、きちんと終わらせようとする。" },
      { id: 12, axis: "X2", text: "長期的なプロジェクトでも、コツコツ続けることができる。" },

      // I1 発信・存在感軸
      { id: 13, axis: "I1", text: "人前で話すことに、そこまで強い抵抗はない。" },
      { id: 14, axis: "I1", text: "自分の考えや経験を、SNSやブログなどで発信したくなる。" },
      { id: 15, axis: "I1", text: "場が静かすぎると、つい話題を振ったり盛り上げたりしてしまう。" },
      { id: 16, axis: "I1", text: "自分の意見をハッキリ言う方だと思う。" },
      { id: 17, axis: "I1", text: "初対面の人とも、わりとすぐに会話を広げられる。" },
      { id: 18, axis: "I1", text: "「あなたがいると場の雰囲気が明るくなる」と言われたことがある。" },

      // I2 説得・推進軸
      { id: 19, axis: "I2", text: "みんなの意見を聞いたうえで、「じゃあこうしよう」と方向性を示すことが多い。" },
      { id: 20, axis: "I2", text: "企画やアイデアを、人に分かりやすくプレゼンするのが好きだ。" },
      { id: 21, axis: "I2", text: "相手に納得してもらえる説明の仕方を考えるのが得意だ。" },
      { id: 22, axis: "I2", text: "チームや周囲を巻き込みながら、物事を前に進めるのが好きだ。" },
      { id: 23, axis: "I2", text: "自分がいいと思ったものは、人にも勧めたくなる。" },
      { id: 24, axis: "I2", text: "会議や話し合いで、最終的に結論をまとめる役割になることが多い。" },

      // T1 ロジカル・分析軸
      { id: 25, axis: "T1", text: "情報を聞いたとき「なぜそうなるのか？」を考えたくなる。" },
      { id: 26, axis: "T1", text: "問題が起きると、原因を分析して再発防止策を考える。" },
      { id: 27, axis: "T1", text: "データや数字を見て判断するのが好きだ。" },
      { id: 28, axis: "T1", text: "物事のメリット・デメリットを整理してから決めたいタイプだ。" },
      { id: 29, axis: "T1", text: "複雑な話を構造化して、図や箇条書きでまとめるのが得意だ。" },
      { id: 30, axis: "T1", text: "先のリスクや抜け漏れに、比較的早く気づく方だ。" },

      // T2 学習・探究軸
      { id: 31, axis: "T2", text: "興味を持ったテーマは、ネットや本で徹底的に調べたくなる。" },
      { id: 32, axis: "T2", text: "学びのための講座や本に、お金や時間を使うことに抵抗が少ない。" },
      { id: 33, axis: "T2", text: "「なぜ？」「どういう仕組み？」と深く掘り下げて考えるのが好きだ。" },
      { id: 34, axis: "T2", text: "一度ハマった分野については、人より詳しくなりがちだ。" },
      { id: 35, axis: "T2", text: "新しい知識や考え方に触れるとワクワクする。" },
      { id: 36, axis: "T2", text: "学んだことを自分なりに整理して、メモやノートにまとめることが多い。" },

      // R1 共感・ケア軸
      { id: 37, axis: "R1", text: "人の表情や声のトーンから、気持ちの変化に敏感だと思う。" },
      { id: 38, axis: "R1", text: "悩んでいる人の話を聞くと、つい親身になってしまう。" },
      { id: 39, axis: "R1", text: "相手が傷つかないような言い方を選びがちだ。" },
      { id: 40, axis: "R1", text: "相談されることが多い方だ。" },
      { id: 41, axis: "R1", text: "相手の立場に立って考える癖がある。" },
      { id: 42, axis: "R1", text: "誰かが疎外されている雰囲気に気づくと、放っておけない。" },

      // R2 協働・チーム軸
      { id: 43, axis: "R2", text: "一人でやるより、誰かと一緒に進める方がやる気が出る。" },
      { id: 44, axis: "R2", text: "チームのメンバーそれぞれの強みや個性を意識して見ている。" },
      { id: 45, axis: "R2", text: "役割分担やスケジュールを調整することが多い。" },
      { id: 46, axis: "R2", text: "場の空気がギスギスしていると、なんとか和らげたくなる。" },
      { id: 47, axis: "R2", text: "みんなが気持ちよく働けるように、裏でサポートするのが得意だ。" },
      { id: 48, axis: "R2", text: "会議や作業の前後に、メンバーに声をかけてフォローすることが多い。" }
    ];

    // ---- 質問描画 ----
    const container = document.getElementById("questionsContainer");

    questions.forEach((q, index) => {
      const wrap = document.createElement("div");
      wrap.className = "question";

      const title = document.createElement("div");
      title.className = "question-title";
      title.textContent = `${index + 1}. ${q.text}`;
      wrap.appendChild(title);

      const options = document.createElement("div");
      options.className = "options";

      const labels = [
        "1：まったく当てはまらない",
        "2：あまり当てはまらない",
        "3：どちらともいえない",
        "4：かなり当てはまる",
        "5：とても当てはまる"
      ];

      for (let value = 1; value <= 5; value++) {
        const label = document.createElement("label");
        label.className = "option";
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `q${q.id}`;
        input.value = value;
        label.appendChild(input);
        label.appendChild(document.createTextNode(labels[value - 1]));
        options.appendChild(label);
      }

      wrap.appendChild(options);
      container.appendChild(wrap);
    });

    // ---- 採点処理 ----
    const form = document.getElementById("quizForm");
    const resultCard = document.getElementById("resultCard");
    const resultContent = document.getElementById("resultContent");
    let radarChart = null;
    let latestShareText = "";
const shareDiv = document.getElementById("resultShare");
const copyBtn = document.getElementById("copyResultBtn");
const shareBtn = document.getElementById("shareResultBtn");
const shareMsg = document.getElementById("shareMessage");


    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const answers = {};
      let allAnswered = true;

      questions.forEach(q => {
        const selected = form.querySelector(`input[name="q${q.id}"]:checked`);
        if (!selected) {
          allAnswered = false;
        } else {
          answers[q.id] = Number(selected.value);
        }
      });

      if (!allAnswered) {
        alert("まだ答えていない質問があります。すべての質問に回答してください。");
        return;
      }

      // 軸ごとのスコアと最大値
      const axisScores = {};
      const axisMax = {};
      Object.keys(axes).forEach(axisId => {
        axisScores[axisId] = 0;
        axisMax[axisId] = 0;
      });

      questions.forEach(q => {
        const axisId = q.axis;
        axisScores[axisId] += answers[q.id];
        axisMax[axisId] += 5; // 各質問の最大値は5
      });

      // ドメイン集計
      const domainScores = {};
      const domainMax = {};
      Object.values(axes).forEach(a => {
        if (!domainScores[a.domain]) {
          domainScores[a.domain] = 0;
          domainMax[a.domain] = 0;
        }
        domainScores[a.domain] += axisScores[a.id];
        domainMax[a.domain] += axisMax[a.id];
      });

      // 軸スコア→％＆並べ替え
      const axisResultList = Object.keys(axes).map(axisId => {
        const meta = axes[axisId];
        const raw = axisScores[axisId];
        const max = axisMax[axisId] || 1;
        const percent = Math.round(raw / max * 100);
        return {
          id: axisId,
          label: meta.label,
          domain: meta.domain,
          rawScore: raw,
          percent,
          max
        };
      }).sort((a, b) => b.percent - a.percent);

      const top3 = axisResultList.slice(0, 3);

      // ドメインスコア→％
      const domainResultList = Object.keys(domainScores).map(domainName => {
        const raw = domainScores[domainName];
        const max = domainMax[domainName] || 1;
        const percent = Math.round(raw / max * 100);
        return { domain: domainName, rawScore: raw, max, percent };
      }).sort((a, b) => b.percent - a.percent);

      // 結果HTML生成
      let html = "";

      html += `<div class="result-title">4ドメインのバランス</div>`;
      html += `<p class="small">数字が高いほど、そのドメインの才能を今よく使っている可能性が高いです。</p>`;

      domainResultList.forEach((d, index) => {
        html += `
          <div class="axis-row">
            <div class="axis-label">
              ${index + 1}. ${d.domain}
            </div>
            <div class="axis-bar-wrap">
              <div class="axis-bar" style="width:${d.percent}%;"></div>
            </div>
            <div class="axis-percent">${d.percent}%</div>
          </div>
        `;
      });

      html += `<p class="small">${domainResultList.map(d => `<strong>${d.domain}</strong>：${domainDescriptions[d.domain]}`).join("<br>")}</p>`;

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">8軸の結果（上位3つが今のメイン才能）</div>`;

      axisResultList.forEach((a, index) => {
        html += `
          <div class="axis-row">
            <div class="axis-label">
              ${index + 1}. ${a.label}
              <span class="small">（${a.domain}）</span>
              ${index < 3 ? `<span class="badge">メイン才能</span>` : ""}
            </div>
            <div class="axis-bar-wrap">
              <div class="axis-bar" style="width:${a.percent}%;"></div>
            </div>
            <div class="axis-percent">${a.percent}%</div>
          </div>
        `;
      });

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">上位3軸の解説</div>`;
      top3.forEach(a => {
        html += `
          <p>
            <strong>${a.label}</strong>（${a.domain}）<br>
            <span class="small">${axisDescriptions[a.id] || ""}</span>
          </p>
        `;
      });

      html += `<p class="small">※この結果は、あくまで「今のあなたがよく使っている才能のパターン」です。<br>しっくりくるところ・意外だったところをメモしながら、自分の経験と照らし合わせてみてください。</p>`;

      resultContent.innerHTML = html;
      resultCard.style.display = "block";
            resultContent.innerHTML = html;
      resultCard.style.display = "block";

      // ★ ここからシェア用テキストを作る
      let shareText = "【才能8軸診断 結果】\n\n";

      shareText += "■ 4ドメインのバランス\n";
      domainResultList.forEach(d => {
        shareText += `・${d.domain}: ${d.percent}%\n`;
      });

      shareText += "\n■ 上位3軸\n";
      top3.forEach(a => {
        shareText += `・${a.label}（${a.domain}）: ${a.percent}%\n`;
      });

      shareText += "\n診断ツールはこちら：\n";
      shareText += "https://sayavision.github.io/talent-8axis-test/\n";

      latestShareText = shareText;
      shareDiv.style.display = "block";
      shareMsg.textContent = "";
      // ★ ここまで追加


      // レーダーチャート描画
      const ctx = document.getElementById("domainRadar").getContext("2d");
      const labels = domainResultList.map(d => d.domain);
      const data = domainResultList.map(d => d.percent);

      if (radarChart) {
        radarChart.data.labels = labels;
        radarChart.data.datasets[0].data = data;
        radarChart.update();
      } else {
        radarChart = new Chart(ctx, {
          type: "radar",
          data: {
            labels: labels,
            datasets: [{
              label: "ドメインバランス",
              data: data,
              fill: true,
              backgroundColor: "rgba(75, 123, 236, 0.2)",
              borderColor: "rgba(75, 123, 236, 1)",
              pointBackgroundColor: "rgba(75, 123, 236, 1)"
            }]
          },
          options: {
            responsive: true,
            scales: {
              r: {
                suggestedMin: 0,
                suggestedMax: 100,
                ticks: { stepSize: 20 }
              }
            }
          }
        });
      }

      resultCard.scrollIntoView({ behavior: "smooth" });
    });
    // ★ シェアボタンの動き
copyBtn.onclick = async () => {
  if (!latestShareText) {
    shareMsg.textContent = "先に診断を完了してね。";
    return;
  }
  try {
    await navigator.clipboard.writeText(latestShareText);
    shareMsg.textContent = "結果テキストをコピーしました。好きなアプリに貼りつけて使ってね。";
  } catch (e) {
    shareMsg.textContent = "コピーに失敗しました…ブラウザによって使えない場合があります。";
  }
};

shareBtn.onclick = async () => {
  if (!latestShareText) {
    shareMsg.textContent = "先に診断を完了してね。";
    return;
  }
  if (navigator.share) {
    try {
      await navigator.share({
        title: "才能8軸診断 結果",
        text: latestShareText
      });
      shareMsg.textContent = "共有メニューを開きました。";
    } catch (e) {
      shareMsg.textContent = "共有がキャンセルされました。";
    }
  } else {
    shareMsg.textContent = "このブラウザは共有機能に対応していないので、コピー機能を使ってね。";
  }
};

  </script>

</body>
</html>
